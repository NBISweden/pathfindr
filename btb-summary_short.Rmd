---
#title: "CAW view"
#author: "Markus Mayrhofer"
#date: "25 oktober 2017"
output: html_document
---

<!-- Logo -->
![](CAW_logo.png)

<!-- Markdown setup -->
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,comment = '',warning=F,error = F)
```

 <!-- This script reads from a folder containing the CAW output, plus copy number data generated by controlfreec.-->
```{r,include=FALSE}
library(ggplot2)
library(ggrepel)
library(VariantAnnotation)
library(gridExtra)
chrsz=structure(list(chr = c("1", "2", "3", "4", "5", "6", "7", "8", 
"9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", 
"20", "21", "22", "X", "Y"), starts = c(0, 253902921, 500669562, 
703689723, 898025604, 1084280925, 1259870526, 1424144247, 1574191848, 
1717288929, 1855896810, 1995944331, 2134165212, 2253485013, 2363996694, 
2470839615, 2565902256, 2654091777, 2739309138, 2802869979, 2871941700, 
2923598421, 2979326382, 3140008743), length = c(248902921, 241766641, 
198020161, 189335881, 181255321, 170589601, 159273721, 145047601, 
138097081, 133607881, 135047521, 133220881, 114319801, 105511681, 
101842921, 90062641, 83189521, 80217361, 58560841, 64071721, 
46656721, 50727961, 155682361, 56827081)), .Names = c("chr", 
"starts", "length"), row.names = c(NA, -24L), class = "data.frame")
#sampleDir='~/BTBdata/' # current dev sample
#sampleDir='.' # we assume we are in a sample dir
```

<!-- First, make a list of files to read and visualize -->
```{r,include=FALSE,echo=FALSE}
files=dir(recursive = T,full.names = T)
files=files[-grep(pattern = '.png',x = files)]
# control freec files
freec_Tratio_file=files[grep(pattern = 'T.hg38.pileup.gz_ratio.txt',files)]
freec_Nratio_file=files[grep(pattern = 'T.hg38.pileup.gz_normal_ratio.txt',files)]
freec_Tbaf_file=files[grep(pattern = 'T.hg38.pileup.gz_BAF.txt',files)]
freec_Nbaf_file=files[grep(pattern = 'B.hg38.pileup.gz_BAF.txt',files)]
freec_info_file=files[grep(pattern = 'hg38.pileup.gz_info.txt',files)]
# VEP structural variant files
vep_Tstruct_file=grep(pattern = glob2rx("*VEP/Manta*somaticSV.ann.vcf"),files,value = T)
vep_Nstruct_file=grep(pattern = glob2rx("*VEP/Manta*diploidSV.ann.vcf"),files,value = T)
# VEP small variant files
vep_Tsmall_file=grep(pattern = glob2rx("*VEP/haplotypecaller*T.vcf.ann.vcf"),files,value = T)
vep_Nsmall_file=grep(pattern = glob2rx("*VEP/haplotypecaller*N.vcf.ann.vcf"),files,value = T)
# snpEff Murect2 file
snpEff_mutect2_file=grep(pattern = glob2rx("*SnpEff/mutect2_*vcf.ann.vcf"),files,value = T)
```


<!-- At top of document, list the files found and used -->
```{r,echo=F,include=T}
{
  cat(date(),'\n')
  cat('Current folder:', getwd(),'\n')
}
{
  cat('Folder Content:\n')
  print(files)
}

```

